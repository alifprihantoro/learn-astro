---
import Wrapper from '@components/Wraper.astro'
import HeaderBlog from '@layouts/blog/Header'
import getBlogMd from '@utils/getBlogMd'

export async function getStaticPaths() {
  const posts = await Astro.glob('../../posts/blog/**/*.md')
  return posts.map((post) => {
    const frontmatter = post.frontmatter
    const TITLE = frontmatter.title
    let slug = frontmatter.slug
    slug =
      slug === undefined || slug === false
        ? getBlogMd(post.file)
        : frontmatter.slug
    const DESCRIPTION = frontmatter.description
    const Content = post.Content
    let AUTHOR = frontmatter.author
    AUTHOR =
      AUTHOR === undefined ? { name: 'Alief Prihantoro', uri: '#' } : AUTHOR
    const DATE = frontmatter.date
    return {
      params: { slug },
      props: { TITLE, Content, slug, DESCRIPTION, AUTHOR, DATE },
    }
  })
}

const { TITLE, Content, slug, DESCRIPTION, AUTHOR, DATE } = Astro.props
const SEO = {
  TITLE: TITLE,
  LINK: `/notes/${slug}`,
  IMG: '',
  DESCRIPTION: TITLE + DESCRIPTION,
}
---

<Wrapper SEO={SEO}>
  <HeaderBlog TITLE={TITLE} slug={slug} AUTHOR={AUTHOR} DATE={DATE} />
  <article class='prose m-5'>
    <Content />
  </article>
</Wrapper>
